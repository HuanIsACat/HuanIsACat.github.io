<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Huan's Adventure Map</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&family=UnifrakturMaguntia&family=ZCOOL+XiaoWei&display=swap" rel="stylesheet">

    <style>
        :root {
            /* 基础颜色变量 */
            --bg-parchment: #f3eacb;
            --bg-card: #fffef0;
            --ink-color: #2c241b;
            --ink-light: #5c4d3c;
            --accent-red: #8a2c2c;
            --border-color: #8b7355;
            
            /* 1. 字体变量定义 */
            --font-title-fancy: 'UnifrakturMaguntia', cursive; /* 花哨标题 */
            --font-body-en: 'Caveat', cursive;                 /* 英文手写 */
            --font-body-zh: 'ZCOOL XiaoWei', serif;            /* 中文古风 */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: #1a1a1a;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            font-family: var(--font-body-en); /* 默认字体 */
            color: var(--ink-color);
        }

        /* 语言切换逻辑 */
        .content-en { display: none; }
        body.lang-en .content-en { display: block; }
        body.lang-en .content-zh { display: none; }

        /* 语言切换按钮 */
        .lang-switch {
            position: fixed;
            top: 20px; right: 20px; z-index: 10001;
            padding: 5px 10px;
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            cursor: pointer;
            font-family: var(--font-body-zh);
            font-weight: bold;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }

        /* 地图视口 */
        .map-viewport {
            position: relative;
            width: 100%; height: 100%;
            overflow: auto;
            -webkit-overflow-scrolling: touch;
            cursor: grab;
            background: #d4c5a3;
        }

        /* 2. 背景地图设置 */
        .map-layer {
            position: relative;
            min-width: 1600px; 
            min-height: 1200px;
            display: block;
            /* 这里使用了你提供的新链接 */
            background-image: url('https://i.redd.it/36tc6drz7gu51.jpg');
            background-size: cover;
            background-position: center;
            /* 稍微加一点滤镜让它看起来更旧 */
            filter: sepia(0.3) contrast(1.05); 
        }

        /* 全屏暗角遮罩 */
        .vignette-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none; z-index: 5;
            background: radial-gradient(circle at center, transparent 60%, rgba(43, 32, 24, 0.4) 100%);
            box-shadow: inset 0 0 100px rgba(0,0,0,0.5);
        }

        /* ------ 图标标记 (Marker) ------ */
        .marker {
            position: absolute;
            width: 90px; height: 90px;
            z-index: 10;
            transform: translate(-50%, -50%);
            cursor: pointer;
            animation: float 3s ease-in-out infinite;
        }
        .marker:hover { filter: drop-shadow(0 0 8px rgba(255, 250, 240, 0.6)); }

        @keyframes float {
            0%, 100% { transform: translate(-50%, -50%) translateY(0); }
            50% { transform: translate(-50%, -50%) translateY(-5px); }
        }

        .marker-icon {
            width: 100%; height: 100%;
            fill: var(--ink-color);
            stroke: var(--bg-card); 
            stroke-width: 1.5;
            transition: transform 0.2s;
        }
        .marker:hover .marker-icon { transform: scale(1.1); }

        /* ------ 3. 华丽的弹窗卡片 (Card Popup) ------ */
        .card-popup {
            position: absolute;
            bottom: 80px; 
            left: 50%;
            transform: translateX(-50%);
            width: 350px;
            
            background-color: var(--bg-card);
            
            /* 【核心修改】：双线边框 + Outline */
            border: 3px double var(--border-color);
            outline: 1px solid var(--border-color);
            outline-offset: 4px; /* 轮廓线稍微往外扩一点 */
            
            padding: 25px 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            
            opacity: 0; visibility: hidden;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            pointer-events: none;
        }

        /* 装饰性角标 (十字花纹) */
        .card-popup::before, .card-popup::after {
            position: absolute;
            font-family: serif; font-size: 24px;
            color: var(--border-color); line-height: 1;
        }
        .card-popup::before { content: "✥"; top: 3px; left: 3px; }
        .card-popup::after { content: "✥"; bottom: 3px; right: 3px; }

        .marker.active .card-popup, .marker:hover .card-popup {
            opacity: 1; visibility: visible;
            pointer-events: auto;
            transform: translateX(-50%) translateY(-10px);
        }

        /* ------ 字体应用规则 ------ */
        
        /* 标题字体设置 */
        .card-title {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 5px;
            border-bottom: 1px solid var(--ink-light);
            padding-bottom: 10px;
            color: var(--accent-red);
        }
        /* 中文标题用古风体 */
        .card-title.content-zh { font-family: var(--font-body-zh); font-weight: bold; }
        /* 英文标题用中世纪花哨体 */
        .card-title.content-en { font-family: var(--font-title-fancy); letter-spacing: 1px; }

        /* 副标题设置 */
        .card-subtitle {
            font-size: 1.1rem; text-align: center;
            color: var(--ink-light); margin-bottom: 15px;
        }
        .card-subtitle.content-zh { font-family: var(--font-body-zh); }
        .card-subtitle.content-en { font-family: var(--font-body-en); font-weight: 700; text-transform: uppercase;}

        /* 正文设置 */
        .card-content { font-size: 1.1rem; line-height: 1.6; }
        .card-content .content-zh { font-family: var(--font-body-zh); }
        .card-content .content-en { font-family: var(--font-body-en); font-size: 1.3rem; /* 手写体稍微大一点才清晰 */ }

        /* 属性表格 */
        .stats-row { display: flex; justify-content: space-around; margin: 15px 0; border-top: 1px dashed var(--ink-light); border-bottom: 1px dashed var(--ink-light); padding: 10px 0;}
        .stat-item { text-align: center; }
        .stat-item label { font-size: 0.8rem; display: block; font-weight: bold; font-family: var(--font-title-fancy); letter-spacing: 1px;}
        .stat-item span { font-size: 1.4rem; font-family: var(--font-title-fancy); }

        .link-list { list-style: none; margin-top: 10px; }
        .link-list a { text-decoration: none; color: var(--ink-color); display: flex; align-items: center; padding: 5px 0; transition: color 0.2s;}
        .link-list a:hover { color: var(--accent-red); }
        .link-list .content-zh { font-family: var(--font-body-zh); }
        .link-list .content-en { font-family: var(--font-body-en); font-size: 1.2rem; font-weight: bold;}

        /* 移动端适配 */
        @media (max-width: 768px) {
            .card-popup {
                position: fixed; top: auto; bottom: 20px; left: 50%;
                transform: translateX(-50%) translateY(20px);
                width: 95%; max-width: 450px; padding: 15px 10px;
            }
            .marker.active .card-popup { transform: translateX(-50%) translateY(0); }
            .stats-row { flex-wrap: wrap; gap: 10px; }
            .stat-item { flex: 1 1 30%; }
        }
    </style>
</head>
<body class="lang-zh">

    <div class="lang-switch" onclick="switchLanguage()">
        <span class="content-zh">English Version</span>
        <span class="content-en">切换为中文</span>
    </div>

    <div class="vignette-overlay"></div>

    <div class="map-viewport" id="mapContainer">
        <div class="map-layer" style="width: 1600px; height: 1200px;">
            
            <div class="marker" style="top: 45%; left: 52%;" onclick="togglePopup(this)">
                <svg class="marker-icon" viewBox="0 0 100 100" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="50" cy="50" r="45" fill="#f3eacb" stroke-width="2"/>
                    <path d="M50 5 L50 95 M5 50 L95 50" stroke-width="1.5" stroke="#8b7355"/>
                    <path d="M50 20 C35 25 30 50 30 65 C30 80 50 85 50 85 C50 85 70 80 70 65 C70 50 65 25 50 20 Z" fill="#2c241b" stroke="none"/>
                    <circle cx="50" cy="55" r="5" fill="#f3eacb"/>
                </svg>

                <div class="card-popup">
                    <div class="card-title content-zh">冒险者档案</div>
                    <div class="card-title content-en">Adventurer Profile</div>
                    
                    <div class="card-subtitle content-zh">Huan the Nerd</div>
                    <div class="card-subtitle content-en">Human Scholar</div>
                    
                    <div class="card-content">
                        <p class="content-zh">正在数据之海中探索的人类法师。随身携带一本写满代码符文的卷轴。</p>
                        <p class="content-en">A human wizard exploring the digital seas. Always carries a scroll filled with coding runes.</p>
                        
                        <div class="stats-row">
                            <div class="stat-item"><label>INT</label><span>18</span></div>
                            <div class="stat-item"><label>WIS</label><span>14</span></div>
                            <div class="stat-item"><label>CHA</label><span>16</span></div>
                        </div>

                        <p style="text-align:center; margin-top:10px;">
                            <span class="content-zh">❤ 魔宠：白猫囧囧</span>
                            <span class="content-en">❤ Familiar: Jiong Jiong</span>
                        </p>
                    </div>
                </div>
            </div>

            <div class="marker" style="top: 30%; left: 35%;" onclick="togglePopup(this)">
                <svg class="marker-icon" viewBox="0 0 100 100" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="50" cy="50" r="45" fill="#f3eacb" stroke-width="2"/>
                    <rect x="25" y="30" width="50" height="40" rx="5" fill="#fffef0" stroke="#2c241b" stroke-width="2"/>
                    <rect x="20" y="30" width="5" height="40" fill="#8b7355"/>
                    <rect x="75" y="30" width="5" height="40" fill="#8b7355"/>
                    <path d="M75 25 L85 15 L85 20 L75 30 Z" fill="#2c241b" stroke="none"/>
                    <line x1="75" y1="25" x2="60" y2="40" stroke="#2c241b" stroke-width="2"/>
                </svg>

                <div class="card-popup">
                    <div class="card-title content-zh">上古卷轴</div>
                    <div class="card-title content-en">Library of Scrolls</div>
                    
                    <div class="card-content">
                        <p class="content-zh">这里存放着关于技术与哲学的思考记录。</p>
                        <p class="content-en">Records of thoughts on technology and philosophy.</p>
                        <ul class="link-list">
                            <li><a href="#"><span class="content-zh">✦ 前端炼金术笔记</span><span class="content-en">✦ Front-end Alchemy Notes</span></a></li>
                            <li><a href="#"><span class="content-zh">✦ 龙与地下城跑团实录</span><span class="content-en">✦ D&D Session Logs</span></a></li>
                            <li><a href="#"><span class="content-zh">✦ 关于爱沙尼亚的冬天</span><span class="content-en">✦ Notes on Estonian Winter</span></a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="marker" style="top: 60%; left: 70%;" onclick="togglePopup(this)">
                <svg class="marker-icon" viewBox="0 0 100 100" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="50" cy="50" r="45" fill="#f3eacb" stroke-width="2"/>
                    <circle cx="50" cy="35" r="25" fill="#fffef0" stroke="#2c241b" stroke-width="2"/>
                    <path d="M30 60 L70 60 L65 70 L35 70 Z" fill="#8b7355" stroke="#2c241b" stroke-width="1"/>
                    <circle cx="55" cy="30" r="5" fill="#f3eacb" opacity="0.8"/>
                </svg>

                <div class="card-popup">
                    <div class="card-title content-zh">记忆碎片</div>
                    <div class="card-title content-en">Crystal Visions</div>
                    
                    <div class="card-content">
                        <p class="content-zh">透过水晶球，你可以看到过去的影像。</p>
                        <p class="content-en">View images and recordings from the past.</p>
                        <ul class="link-list">
                            <li><a href="#"><span class="content-zh">✦ [相册] 欧洲游记</span><span class="content-en">✦ [Gallery] European Travels</span></a></li>
                            <li><a href="#"><span class="content-zh">✦ [视频] 2024 年度总结</span><span class="content-en">✦ [Video] 2024 Year End Summary</span></a></li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        let currentLang = 'zh';

        function switchLanguage() {
            const body = document.body;
            currentLang = body.classList.contains('lang-zh') ? 'en' : 'zh';
            body.classList.remove('lang-zh', 'lang-en');
            body.classList.add(`lang-${currentLang}`);
            document.querySelectorAll('.marker').forEach(m => m.classList.remove('active'));
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            document.body.classList.add('lang-zh'); 
        });

        function togglePopup(element) {
            event.stopPropagation();
            const isMobile = window.matchMedia("(max-width: 768px)").matches;
            if (isMobile) {
                if (element.classList.contains('active')) {
                    element.classList.remove('active');
                    return;
                }
                document.querySelectorAll('.marker').forEach(m => m.classList.remove('active'));
                element.classList.add('active');
            } else {
                const isActive = element.classList.contains('active');
                document.querySelectorAll('.marker').forEach(m => m.classList.remove('active'));
                if (!isActive) element.classList.add('active');
            }
        }

        document.getElementById('mapContainer').addEventListener('click', function() {
            document.querySelectorAll('.marker').forEach(m => m.classList.remove('active'));
        });
    </script>
</body>
</html>